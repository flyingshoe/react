{"version":3,"sources":["pages/covid.js"],"names":["Covid","useState","infected","lastUpdatedAtApify","covidData","setCovidData","showLoader","setLoader","curData","setCurData","useEffect","refineGraph","fetch","then","data","json","newData","lastCase","map","index","d","Date","replace","day","toLocaleString","month","monthStr","year","newCases","dayMonth","dayNum","parseInt","monthNum","filter","uniqueVals","includes","push","renderBarChart","dataKey","stroke","fill","cursor","style","height","width","border","borderRadius","margin","userSelect","textAlign","transform","fontWeight","color","fontSize","length","className","display","verticalAlign","borderColor","borderWidth","marginTop","aspect","active","variant","onClick","x","currentTarget","blur"],"mappings":"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","file":"static/js/6.a5be0cd9.chunk.js","sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport {\r\n  BarChart,\r\n  Bar,\r\n  XAxis,\r\n  YAxis,\r\n  Tooltip,\r\n  ResponsiveContainer,\r\n} from \"recharts\";\r\nimport \"../styles/loadScreen.css\";\r\nimport { Container, Button } from \"react-bootstrap\";\r\n\r\nexport default function Covid() {\r\n  const [covidData, setCovidData] = useState([\r\n    {\r\n      infected: 57784,\r\n      lastUpdatedAtApify: \"2020-10-01T14:45:00.000Z\",\r\n    },\r\n    {\r\n      infected: 57794,\r\n      lastUpdatedAtApify: \"2020-10-02T14:40:00.000Z\",\r\n    },\r\n  ]);\r\n  //const [covidData, setCovidData] = useState(require(\"./covid.json\"));\r\n  const [showLoader, setLoader] = useState(true);\r\n  const [curData, setCurData] = useState(\"infected\");\r\n\r\n  useEffect(() => {\r\n    refineGraph(covidData);\r\n    fetch(\r\n      \"https://api.apify.com/v2/datasets/suHgi59tSfu02VsRO/items?format=json&clean=1&fields=infected,lastUpdatedAtApify\"\r\n    )\r\n      .then((data) => data.json())\r\n      .then((json) => {\r\n        setCovidData(json);\r\n        refineGraph(json);\r\n        //Hide Loader\r\n        setLoader(false);\r\n      });\r\n  // eslint-disable-next-line\r\n  }, []);\r\n\r\n  const refineGraph = (covidData) => {\r\n    //Make a copy of covidData\r\n    var newData = [...covidData];\r\n\r\n    //Add formatted date string\r\n    let lastCase = 0;\r\n    newData = newData.map((data, index) => {\r\n      //Create a new Date Object\r\n      const d = new Date(data.lastUpdatedAtApify.replace(/Z$/, \"\"));\r\n      let day = d.toLocaleString(\"en\", { day: \"2-digit\" });\r\n      let month = d.toLocaleString(\"en\", { month: \"2-digit\" });\r\n      let monthStr = d.toLocaleString(\"en\", { month: \"short\" });\r\n      let year = d.toLocaleString(\"en\", { year: \"numeric\" });\r\n\r\n      //Get new cases - cases today minus cases yesterday\r\n      let newCases =\r\n        index > 0 ? data.infected - newData[index - 1].infected : 0;\r\n\r\n      //Check for abnormal Data and replace it with \"lastCase\"\r\n      newCases < 1 ? (newCases = lastCase) : (lastCase = newCases);\r\n\r\n      return {\r\n        ...data,\r\n        day: day,\r\n        month: month,\r\n        monthStr: monthStr,\r\n        year: year,\r\n        dayMonth: `${day}-${monthStr}`,\r\n        dayNum: parseInt(d.toLocaleString(\"en\", { day: \"numeric\" })),\r\n        monthNum: parseInt(d.toLocaleString(\"en\", { month: \"numeric\" })),\r\n        newCases: newCases,\r\n      };\r\n    });\r\n\r\n    //Clean up the Data\r\n    //17th to 29th May is problematic, remove it. Also remove extreme values like >10k cases\r\n    newData = newData.filter((data) => ((data.dayNum < 17 || data.dayNum > 29 || data.monthNum !== 5)) && data.newCases <= 10000);\r\n\r\n    //Remove duplicated items by DATE\r\n    let uniqueVals = [];\r\n    newData = newData.filter((data) => {\r\n      if ( !uniqueVals.includes(data.dayMonth) && data.infected != null ) {\r\n        uniqueVals.push(data.dayMonth);\r\n        return data;\r\n      }\r\n      return null;\r\n    });\r\n\r\n    //Save Data\r\n    setCovidData(newData);\r\n  };\r\n\r\n  const renderBarChart = (\r\n    <BarChart data={covidData} >\r\n      <Bar dataKey={curData} stroke=\"var(--bs-teal)\" fill=\"var(--bs-teal)\" />\r\n      <XAxis stroke=\"var(--bs-gray-dark)\" dataKey=\"dayMonth\" />\r\n      <YAxis stroke=\"var(--bs-gray-dark)\" />\r\n      <Tooltip cursor={true}/>\r\n    </BarChart>\r\n  );\r\n  return (\r\n    <Container>\r\n      <div\r\n        style={{\r\n          height: \"200px\",\r\n          width: \"200px\",\r\n          border: \"6px solid var(--bs-teal)\",\r\n          borderRadius: \"50%\",\r\n          margin: \"50px auto\",\r\n          userSelect: \"none\",\r\n        }}\r\n      >\r\n        <div\r\n          style={{\r\n            textAlign: \"center\",\r\n            transform: \"translateY(5%)\",\r\n            fontWeight: \"bold\",\r\n            color: \"var(--bs-teal)\",\r\n          }}\r\n        >\r\n          <div style={{ fontSize: \"80px\" }}>\r\n            {covidData[covidData.length - 1].newCases}\r\n          </div>\r\n          <div style={{ fontSize: \"20px\" }}>NEW CASES</div>\r\n        </div>\r\n      </div>\r\n      {showLoader && (\r\n        <h1 style={{ textAlign: \"center\" }}>\r\n          <div\r\n            className=\"loader\"\r\n            style={{\r\n              display: \"inline-block\",\r\n              verticalAlign: \"middle\",\r\n              height: \"calc(1.375rem + 1.5vw)\",\r\n              width: \"calc(1.375rem + 1.5vw)\",\r\n              borderColor: \"var(--bs-teal)\",\r\n              borderWidth:\"4px\",\r\n            }}\r\n          ></div>\r\n          <span style={{ verticalAlign: \"middle\", color: \"var(--bs-teal)\" }}>\r\n            {\" \"}\r\n            Loading Latest Data{\" \"}\r\n          </span>\r\n        </h1>\r\n      )}\r\n      <h3\r\n        style={{\r\n          textAlign: \"center\",\r\n          color: \"var(--bs-info)\",\r\n          marginTop: \"25px\",\r\n        }}\r\n      >\r\n        Last Updated: {covidData[covidData.length - 1].day}{\" \"}\r\n        {covidData[covidData.length - 1].monthStr}{\" \"}\r\n        {covidData[covidData.length - 1].year}\r\n      </h3>\r\n\r\n      {!showLoader && (\r\n        <div style={{ margin: \"60px 0\" }}>\r\n          <div\r\n            style={{\r\n              color: \"var(--bs-teal)\",\r\n              textAlign: \"center\",\r\n              fontSize: \"40px\",\r\n            }}\r\n          >\r\n            {curData === \"infected\" ? \"Total Cases\" : \"New Daily Cases\"}\r\n          </div>\r\n          <ResponsiveContainer width=\"100%\" aspect={2.5}>\r\n            {renderBarChart}\r\n          </ResponsiveContainer>\r\n          <div style={{ marginTop: \"25px\" }}></div>\r\n          <Button\r\n            active={curData === \"infected\" ? true : false}\r\n            variant=\"outline-info\"\r\n            onClick={(x) => {\r\n              setCurData(\"infected\");\r\n              x.currentTarget.blur();\r\n              //Work around to reanimate graph\r\n              setCovidData([...covidData]);\r\n            }}\r\n          >\r\n            Total Cases\r\n          </Button>\r\n          <Button\r\n            active={curData !== \"infected\" ? true : false}\r\n            variant=\"outline-info\"\r\n            onClick={(x) => {\r\n              setCurData(\"newCases\");\r\n              x.currentTarget.blur();\r\n              //Work around to reanimate graph\r\n              setCovidData([...covidData]);\r\n            }}\r\n          >\r\n            New Daily Cases\r\n          </Button>\r\n        </div>\r\n      )}\r\n    </Container>\r\n  );\r\n}\r\n"],"sourceRoot":""}